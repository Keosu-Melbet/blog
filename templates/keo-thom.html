{% extends "base.html" %}

{% block content %}
<div class="container">
    <div class="row">
        <div class="col-lg-9">
            <!-- Page Header -->
            <div class="page-header mb-4">
                <h1 class="text-warning">
                    <i class="fas fa-fire me-2"></i>K√®o Th∆°m H√¥m Nay
                </h1>
                <p class="text-light">C·∫≠p nh·∫≠t t·ª∑ l·ªá k√®o v√† nh·ªØng k√®o th∆°m c√≥ t·ª∑ l·ªá th·∫Øng cao t·ª´ c√°c chuy√™n gia</p>
            </div>

            <!-- Betting Odds Table -->
            <div class="card bg-dark border-warning mb-4">
                <div class="card-header bg-warning text-dark">
                    <h5 class="mb-0"><i class="fas fa-chart-line me-2"></i>T·ª∑ L·ªá K√®o H√¥m Nay</h5>
                </div>
                <div class="card-body">
                    {% if odds %}
                    <div class="table-responsive">
                        <table class="table table-dark table-striped">
                            <thead>
                                <tr>
                                    <th>Tr·∫≠n ƒê·∫•u</th>
                                    <th>Gi·∫£i</th>
                                    <th>Th·ªùi Gian</th>
                                    <th>1X2</th>
                                    <th>T√†i X·ªâu</th>
                                    <th>Ch√¢u √Å</th>
                                    <th>D·ª± ƒêo√°n</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for odd in odds %}
                                <tr>
                                    <td>
                                        <strong class="text-warning">{{ odd.home_team }}</strong> vs 
                                        <strong class="text-warning">{{ odd.away_team }}</strong>
                                    </td>
                                    <td><span class="badge bg-secondary">{{ odd.league or 'N/A' }}</span></td>
                                    <td>{{ odd.match_date.strftime('%H:%M') }}</td>
                                    <td>
                                        <small>
                                            1: {{ "%.2f"|format(odd.home_win) if odd.home_win else 'N/A' }}<br>
                                            X: {{ "%.2f"|format(odd.draw) if odd.draw else 'N/A' }}<br>
                                            2: {{ "%.2f"|format(odd.away_win) if odd.away_win else 'N/A' }}
                                        </small>
                                    </td>
                                    <td>
                                        <small>
                                            T√†i: {{ "%.2f"|format(odd.over_2_5) if odd.over_2_5 else 'N/A' }}<br>
                                            X·ªâu: {{ "%.2f"|format(odd.under_2_5) if odd.under_2_5 else 'N/A' }}
                                        </small>
                                    </td>
                                    <td>
                                        <small>
                                            {{ odd.handicap or 'N/A' }}<br>
                                            {{ "%.2f"|format(odd.handicap_home) if odd.handicap_home else 'N/A' }} | 
                                            {{ "%.2f"|format(odd.handicap_away) if odd.handicap_away else 'N/A' }}
                                        </small>
                                    </td>
                                    <td>
                                        {% if odd.recommendation %}
                                        <span class="badge bg-warning text-dark">{{ odd.recommendation }}</span>
                                        {% if odd.confidence %}
                                        <br><small class="text-muted">ƒê·ªô tin c·∫≠y: {{ odd.confidence }}/5</small>
                                        {% endif %}
                                        {% else %}
                                        <span class="text-muted">Ch∆∞a c√≥</span>
                                        {% endif %}
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    {% else %}
                    <div class="text-center py-5">
                        <i class="fas fa-info-circle fa-3x text-warning mb-3"></i>
                        <h5 class="text-light">Ch∆∞a c√≥ d·ªØ li·ªáu k√®o cho h√¥m nay</h5>
                        <p class="text-muted">Vui l√≤ng quay l·∫°i sau ƒë·ªÉ xem c·∫≠p nh·∫≠t m·ªõi nh·∫•t</p>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Tips Section -->
            <div class="card bg-dark border-warning">
                <div class="card-header bg-warning text-dark">
                    <h5 class="mb-0"><i class="fas fa-lightbulb me-2"></i>M·∫πo Ch·ªçn K√®o Th∆°m</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <h6 class="text-warning"><i class="fas fa-check-circle me-2"></i>Ph√¢n T√≠ch Form</h6>
                            <p class="text-light small">Xem x√©t phong ƒë·ªô g·∫ßn ƒë√¢y c·ªßa hai ƒë·ªôi, th√†nh t√≠ch ƒë·ªëi ƒë·∫ßu v√† t√¨nh h√¨nh l·ª±c l∆∞·ª£ng.</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <h6 class="text-warning"><i class="fas fa-chart-bar me-2"></i>So S√°nh T·ª∑ L·ªá</h6>
                            <p class="text-light small">Theo d√µi s·ª± bi·∫øn ƒë·ªông t·ª∑ l·ªá k√®o t·ª´ nhi·ªÅu nh√† c√°i ƒë·ªÉ t√¨m gi√° tr·ªã t·ªët nh·∫•t.</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <h6 class="text-warning"><i class="fas fa-money-bill-wave me-2"></i>Qu·∫£n L√Ω V·ªën</h6>
                            <p class="text-light small">Ch·ªâ ƒë·∫∑t c∆∞·ª£c v·ªõi s·ªë ti·ªÅn b·∫°n c√≥ th·ªÉ ch·∫•p nh·∫≠n m·∫•t, th∆∞·ªùng kh√¥ng qu√° 5% t√†i kho·∫£n.</p>
                        </div>
                        <div class="col-md-6 mb-3">
                            <h6 class="text-warning"><i class="fas fa-clock me-2"></i>Th·ªùi ƒêi·ªÉm ƒê·∫∑t K√®o</h6>
                            <p class="text-light small">ƒê·∫∑t k√®o s·ªõm ƒë·ªÉ c√≥ t·ª∑ l·ªá t·ªët ho·∫∑c ch·ªù g·∫ßn gi·ªù ƒë·∫•u ƒë·ªÉ c√≥ th√¥ng tin ch√≠nh x√°c.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="col-lg-3">
            <!-- MelBet CTA -->
            <div class="card bg-warning text-dark mb-4">
                <div class="card-body text-center">
                    <h6 class="fw-bold mb-3">üéØ ƒê·∫∑t K√®o T·∫°i MelBet</h6>
                    <p class="small mb-3">T·ª∑ l·ªá k√®o t·ªët nh·∫•t ‚Ä¢ Thanh to√°n nhanh</p>
                    <a href="{{ url_for('dai_ly_melbet') }}" class="btn btn-dark btn-sm">ƒêƒÉng K√Ω Ngay</a>
                </div>
            </div>

            <!-- Quick Stats -->
            <div class="card bg-dark border-secondary mb-4">
                <div class="card-header">
                    <h6 class="text-warning mb-0">Th·ªëng K√™ Nhanh</h6>
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between mb-2">
                        <span class="text-light">K√®o h√¥m nay:</span>
                        <span class="text-warning">{{ odds|length }}</span>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span class="text-light">ƒê·ªô tin c·∫≠y cao:</span>
                        <span class="text-warning">{{ odds|selectattr('confidence', 'ge', 4)|list|length }}</span>
                    </div>
                    <div class="d-flex justify-content-between">
                        <span class="text-light">C√≥ khuy·∫øn ngh·ªã:</span>
                        <span class="text-warning">{{ odds|selectattr('recommendation')|list|length }}</span>
                    </div>
                </div>
            </div>

            <!-- Chatbot Section -->
            <div class="card bg-dark border-warning">
                <div class="card-header bg-warning text-dark">
                    <h6 class="mb-0"><i class="fas fa-robot me-2"></i>K√®o S∆∞ AI</h6>
                </div>
                <div class="card-body text-center">
                    <p class="text-light small mb-3">H·ªó tr·ª£ t∆∞ v·∫•n k√®o 24/7</p>
                    <button class="btn btn-warning btn-sm" onclick="toggleChatbot()">
                        <i class="fas fa-comments me-1"></i>Chat Ngay
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function toggleChatbot() {
    const chatbotToggle = document.getElementById('chatbot-toggle');
    const chatbotIframe = document.getElementById('chatbot-iframe');
    
    if (chatbotIframe.classList.contains('d-none')) {
        chatbotIframe.classList.remove('d-none');
        chatbotToggle.innerHTML = '<i class="fas fa-times fa-lg"></i>';
    } else {
        chatbotIframe.classList.add('d-none');
        chatbotToggle.innerHTML = '<i class="fas fa-comments fa-lg"></i>';
    }
}
</script>
{% endblock %}
